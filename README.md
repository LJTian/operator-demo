# operator-demo
kubebuilder 演示demo

# 目录
- 1-下载kuberbuilder
- 2-创建目录
- 3-初始话项目
- 4-模型及控制器
- 5-添加证书服务器
- 6-添加webhook
- 7-打包测试

# 下载kuberbuilder
- 官方网址[https://book.kubebuilder.io/]
- git 仓库地址[https://github.com/kubernetes-sigs/kubebuilder]
## 安装执行脚本

```shell
curl -L -o kubebuilder https://go.kubebuilder.io/dl/latest/$(go env GOOS)/$(go env GOARCH)
chmod +x kubebuilder && mv kubebuilder /usr/local/bin/
```

# 创建目录
```shell
mkdir <PROJECT_DIR> && cd <PROJECT_DIR>
```

# 初始化项目-模型及控制器

## 一键初始化
```shell
kubebuilder init --domain ljtian.com --repo ljtian.com/mydaemonset
```
> 注意：国内执行时命令会拉取代码出现超时情况，请先配置好代理。出现超时情况且没有生成 ***PROJECT*** 文件情况，请删除重新执行。

## 检查项目信息
```shell
cat PROJECT
```
输出内容
```shell
# Code generated by tool. DO NOT EDIT.
# This file is used to track the info used to scaffold your project
# and allow the plugins properly work.
# More info: https://book.kubebuilder.io/reference/project-config.html
domain: ljtian.com
layout:
- go.kubebuilder.io/v3
projectName: operator-demo
repo: ljtian.com/mydaemonset
version: "3"

```

## 创建API
```shell
kubebuilder create api --group apps --version v1 --kind MyDaemonset
```